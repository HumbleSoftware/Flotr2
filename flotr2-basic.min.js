/*!
  * bean.js - copyright Jacob Thornton 2011
  * https://github.com/fat/bean
  * MIT License
  * special thanks to:
  * dean edwards: http://dean.edwards.name/
  * dperini: https://github.com/dperini/nwevents
  * the entire mootools team: github.com/mootools/mootools-core
  *//*global module:true, define:true*/
!function(e,t,n){typeof module!="undefined"?module.exports=n(e,t):typeof define=="function"&&typeof define.amd=="object"?define(n):t[e]=n(e,t)}("bean",this,function(e,t){var n=window,r=t[e],i=/over|out/,s=/[^\.]*(?=\..*)\.|.*/,o=/\..*/,u="addEventListener",a="attachEvent",f="removeEventListener",l="detachEvent",c=document||{},h=c.documentElement||{},p=h[u],d=p?u:a,v=Array.prototype.slice,m=/click|mouse|menu|drag|drop/i,g=/^touch|^gesture/i,y={one:1},b=function(e,t,n){for(n=0;n<t.length;n++)e[t[n]]=1;return e}({},("click dblclick mouseup mousedown contextmenu mousewheel DOMMouseScroll mouseover mouseout mousemove selectstart selectend keydown keypress keyup orientationchange focus blur change reset select submit load unload beforeunload resize move DOMContentLoaded readystatechange error abort scroll "+(p?"show input invalid touchstart touchmove touchend touchcancel gesturestart gesturechange gestureend message readystatechange pageshow pagehide popstate hashchange offline online afterprint beforeprint dragstart dragenter dragover dragleave drag drop dragend loadstart progress suspend emptied stalled loadmetadata loadeddata canplay canplaythrough playing waiting seeking seeked ended durationchange timeupdate play pause ratechange volumechange cuechange checking noupdate downloading cached updateready obsolete ":"")).split(" ")),w=function(){function e(e,t){while((t=t.parentNode)!==null)if(t===e)return!0;return!1}function t(t){var n=t.relatedTarget;return n?n!==this&&n.prefix!=="xul"&&!/document/.test(this.toString())&&!e(this,n):n===null}return{mouseenter:{base:"mouseover",condition:t},mouseleave:{base:"mouseout",condition:t},mousewheel:{base:/Firefox/.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel"}}}(),E=function(){var e="altKey attrChange attrName bubbles cancelable ctrlKey currentTarget detail eventPhase getModifierState isTrusted metaKey relatedNode relatedTarget shiftKey srcElement target timeStamp type view which".split(" "),t=e.concat("button buttons clientX clientY dataTransfer fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" ")),n=e.concat("char charCode key keyCode".split(" ")),r=e.concat("touches targetTouches changedTouches scale rotation".split(" ")),s="preventDefault",o=function(e){return function(){e[s]?e[s]():e.returnValue=!1}},u="stopPropagation",a=function(e){return function(){e[u]?e[u]():e.cancelBubble=!0}},f=function(e){return function(){e[s](),e[u](),e.stopped=!0}},l=function(e,t,n){var r,i;for(r=n.length;r--;)i=n[r],!(i in t)&&i in e&&(t[i]=e[i])};return function(p,d){var v={originalEvent:p,isNative:d};if(!p)return v;var y,b=p.type,w=p.target||p.srcElement;v[s]=o(p),v[u]=a(p),v.stop=f(v),v.target=w&&w.nodeType===3?w.parentNode:w;if(d){if(b.indexOf("key")!==-1)y=n,v.keyCode=p.which||p.keyCode;else if(m.test(b)){y=t,v.rightClick=p.which===3||p.button===2,v.pos={x:0,y:0};if(p.pageX||p.pageY)v.clientX=p.pageX,v.clientY=p.pageY;else if(p.clientX||p.clientY)v.clientX=p.clientX+c.body.scrollLeft+h.scrollLeft,v.clientY=p.clientY+c.body.scrollTop+h.scrollTop;i.test(b)&&(v.relatedTarget=p.relatedTarget||p[(b==="mouseover"?"from":"to")+"Element"])}else g.test(b)&&(y=r);l(p,v,y||e)}return v}}(),S=function(e,t){return!p&&!t&&(e===c||e===n)?h:e},x=function(){function e(e,t,n,r,i){this.element=e,this.type=t,this.handler=n,this.original=r,this.namespaces=i,this.custom=w[t],this.isNative=b[t]&&e[d],this.eventType=p||this.isNative?t:"propertychange",this.customType=!p&&!this.isNative&&t,this.target=S(e,this.isNative),this.eventSupport=this.target[d]}return e.prototype={inNamespaces:function(e){var t,n;if(!e)return!0;if(!this.namespaces)return!1;for(t=e.length;t--;)for(n=this.namespaces.length;n--;)if(e[t]===this.namespaces[n])return!0;return!1},matches:function(e,t,n){return this.element===e&&(!t||this.original===t)&&(!n||this.handler===n)}},e}(),T=function(){var e={},t=function(n,r,i,s,o){if(!r||r==="*")for(var u in e)u.charAt(0)==="$"&&t(n,u.substr(1),i,s,o);else{var a=0,f,l=e["$"+r],c=n==="*";if(!l)return;for(f=l.length;a<f;a++)if(c||l[a].matches(n,i,s))if(!o(l[a],l,a,r))return}},n=function(t,n,r){var i,s=e["$"+n];if(s)for(i=s.length;i--;)if(s[i].matches(t,r,null))return!0;return!1},r=function(e,n,r){var i=[];return t(e,n,r,null,function(e){return i.push(e)}),i},i=function(t){return(e["$"+t.type]||(e["$"+t.type]=[])).push(t),t},s=function(n){t(n.element,n.type,null,n.handler,function(t,n,r){return n.splice(r,1),n.length===0&&delete e["$"+t.type],!1})},o=function(){var t,n=[];for(t in e)t.charAt(0)==="$"&&(n=n.concat(e[t]));return n};return{has:n,get:r,put:i,del:s,entries:o}}(),N=p?function(e,t,n,r){e[r?u:f](t,n,!1)}:function(e,t,n,r,i){i&&r&&e["_on"+i]===null&&(e["_on"+i]=0),e[r?a:l]("on"+t,n)},C=function(e,t,r){return function(i){return i=E(i||((this.ownerDocument||this.document||this).parentWindow||n).event,!0),t.apply(e,[i].concat(r))}},k=function(e,t,r,i,s,o){return function(u){if(i?i.apply(this,arguments):p?!0:u&&u.propertyName==="_on"+r||!u)u&&(u=E(u||((this.ownerDocument||this.document||this).parentWindow||n).event,o)),t.apply(e,u&&(!s||s.length===0)?arguments:v.call(arguments,u?0:1).concat(s))}},L=function(e,t,n,r,i){return function(){e(t,n,i),r.apply(this,arguments)}},A=function(e,t,n,r){var i,s,u,a=t&&t.replace(o,""),f=T.get(e,a,n);for(i=0,s=f.length;i<s;i++)f[i].inNamespaces(r)&&((u=f[i]).eventSupport&&N(u.target,u.eventType,u.handler,!1,u.type),T.del(u))},O=function(e,t,n,r,i){var u,a=t.replace(o,""),f=t.replace(s,"").split(".");if(T.has(e,a,n))return e;a==="unload"&&(n=L(A,e,a,n,r)),w[a]&&(w[a].condition&&(n=k(e,n,a,w[a].condition,!0)),a=w[a].base||a),u=T.put(new x(e,a,n,r,f[0]&&f)),u.handler=u.isNative?C(e,u.handler,i):k(e,u.handler,a,!1,i,!1),u.eventSupport&&N(u.target,u.eventType,u.handler,!0,u.customType)},M=function(e,t,n){return function(r){var i,s,o=typeof e=="string"?n(e,this):e;for(i=r.target;i&&i!==this;i=i.parentNode)for(s=o.length;s--;)if(o[s]===i)return t.apply(i,arguments)}},_=function(e,t,n){var r,i,u,a,f,l=A,c=t&&typeof t=="string";if(c&&t.indexOf(" ")>0){t=t.split(" ");for(f=t.length;f--;)_(e,t[f],n);return e}u=c&&t.replace(o,""),u&&w[u]&&(u=w[u].type);if(!t||c){if(a=c&&t.replace(s,""))a=a.split(".");l(e,u,n,a)}else if(typeof t=="function")l(e,null,t);else for(r in t)t.hasOwnProperty(r)&&_(e,r,t[r]);return e},D=function(e,t,n,r,i){var s,o,u,a,f=n,l=n&&typeof n=="string";if(t&&!n&&typeof t=="object")for(s in t)t.hasOwnProperty(s)&&D.apply(this,[e,s,t[s]]);else{a=arguments.length>3?v.call(arguments,3):[],o=(l?n:t).split(" "),l&&(n=M(t,f=r,i))&&(a=v.call(a,1)),this===y&&(n=L(_,e,t,n,f));for(u=o.length;u--;)O(e,o[u],n,f,a)}return e},P=function(){return D.apply(y,arguments)},H=p?function(e,t,r){var i=c.createEvent(e?"HTMLEvents":"UIEvents");i[e?"initEvent":"initUIEvent"](t,!0,!0,n,1),r.dispatchEvent(i)}:function(e,t,n){n=S(n,e),e?n.fireEvent("on"+t,c.createEventObject()):n["_on"+t]++},B=function(e,t,n){var r,i,u,a,f,l=t.split(" ");for(r=l.length;r--;){t=l[r].replace(o,"");if(a=l[r].replace(s,""))a=a.split(".");if(!a&&!n&&e[d])H(b[t],t,e);else{f=T.get(e,t),n=[!1].concat(n);for(i=0,u=f.length;i<u;i++)f[i].inNamespaces(a)&&f[i].handler.apply(e,n)}}return e},j=function(e,t,n){var r=0,i=T.get(t,n),s=i.length;for(;r<s;r++)i[r].original&&D(e,i[r].type,i[r].original);return e},F={add:D,one:P,remove:_,clone:j,fire:B,noConflict:function(){return t[e]=r,this}};if(n[a]){var I=function(){var e,t=T.entries();for(e in t)t[e].type&&t[e].type!=="unload"&&_(t[e].element,t[e].type);n[l]("onunload",I),n.CollectGarbage&&n.CollectGarbage()};n[a]("onunload",I)}return F});
//     Underscore.js 1.6.0
//     http://underscorejs.org
//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

(function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){if(e instanceof x)return e;if(!(this instanceof x))return new x(e);this._wrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.6.0";var T=x.each=x.forEach=function(e,t,r){if(e==null)return e;if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(t.call(r,e[i],i,e)===n)return}else{var o=x.keys(e);for(var i=0,s=o.length;i<s;i++)if(t.call(r,e[o[i]],o[i],e)===n)return}return e};x.map=x.collect=function(e,t,n){var r=[];return e==null?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r.push(t.call(n,e,i,s))}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)});if(!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},x.filter=x.select=function(e,t,n){var r=[];return e==null?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&r.push(e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return e==null?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return e==null?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};x.contains=x.include=function(e,t){return e==null?!1:y&&e.indexOf===y?e.indexOf(t)!=-1:C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,x.property(t))},x.where=function(e,t){return x.filter(e,x.matches(t))},x.findWhere=function(e,t){return x.find(e,x.matches(t))},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);var r=-Infinity,i=-Infinity;return T(e,function(e,s,o){var u=t?t.call(n,e,s,o):e;u>i&&(r=e,i=u)}),r},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);var r=Infinity,i=Infinity;return T(e,function(e,s,o){var u=t?t.call(n,e,s,o):e;u<i&&(r=e,i=u)}),r},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r},x.sample=function(e,t,n){return t==null||n?(e.length!==+e.length&&(e=x.values(e)),e[x.random(e.length-1)]):x.shuffle(e).slice(0,Math.max(0,t))};var k=function(e){return e==null?x.identity:x.isFunction(e)?e:x.property(e)};x.sortBy=function(e,t,n){return t=k(t),x.pluck(x.map(e,function(e,r,i){return{value:e,index:r,criteria:t.call(n,e,r,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index-t.index}),"value")};var L=function(e){return function(t,n,r){var i={};return n=k(n),T(t,function(s,o){var u=n.call(r,s,o,t);e(i,u,s)}),i}};x.groupBy=L(function(e,t,n){x.has(e,t)?e[t].push(n):e[t]=[n]}),x.indexBy=L(function(e,t,n){e[t]=n}),x.countBy=L(function(e,t){x.has(e,t)?e[t]++:e[t]=1}),x.sortedIndex=function(e,t,n,r){n=k(n);var i=n.call(r,t),s=0,o=e.length;while(s<o){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return e==null?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return e==null?void 0:t==null||n?e[0]:t<0?[]:u.call(e,0,t)},x.initial=function(e,t,n){return u.call(e,0,e.length-(t==null||n?1:t))},x.last=function(e,t,n){return e==null?void 0:t==null||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,t==null||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return t&&x.every(e,x.isArray)?a.apply(n,e):(T(e,function(e){x.isArray(e)||x.isArguments(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n)};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.partition=function(e,t,n){t=k(t);var r=[],i=[];return T(e,function(e){(t.call(n,e)?r:i).push(e)}),[r,i]},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){if(t?!r||o[o.length-1]!==n:!x.contains(o,n))o.push(n),s.push(e[r])}),s},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.contains(t,e)})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){var e=x.max(x.pluck(arguments,"length").concat(0)),t=new Array(e);for(var n=0;n<e;n++)t[n]=x.pluck(arguments,""+n);return t},x.object=function(e,t){if(e==null)return{};var n={};for(var r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n!="number")return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1},x.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var O=function(){};x.bind=function(e,t){var n,r;if(S&&e.bind===S)return S.apply(e,u.call(arguments,1));if(!x.isFunction(e))throw new TypeError;return n=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=e.prototype;var i=new O;O.prototype=null;var s=e.apply(i,n.concat(u.call(arguments)));return Object(s)===s?s:i}return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){var n=0,r=t.slice();for(var i=0,s=r.length;i<s;i++)r[i]===x&&(r[i]=arguments[n++]);while(n<arguments.length)r.push(arguments[n++]);return e.apply(this,r)}},x.bindAll=function(e){var t=u.call(arguments,1);if(t.length===0)throw new Error("bindAll must be passed function names");return T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t,n){var r,i,s,o=null,u=0;n||(n={});var a=function(){u=n.leading===!1?0:x.now(),o=null,s=e.apply(r,i),r=i=null};return function(){var f=x.now();!u&&n.leading===!1&&(u=f);var l=t-(f-u);return r=this,i=arguments,l<=0?(clearTimeout(o),o=null,u=f,s=e.apply(r,i),r=i=null):!o&&n.trailing!==!1&&(o=setTimeout(a,l)),s}},x.debounce=function(e,t,n){var r,i,s,o,u,a=function(){var f=x.now()-o;f<t?r=setTimeout(a,t-f):(r=null,n||(u=e.apply(s,i),s=i=null))};return function(){s=this,i=arguments,o=x.now();var f=n&&!r;return r||(r=setTimeout(a,t)),f&&(u=e.apply(s,i),s=i=null),u}},x.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},x.wrap=function(e,t){return x.partial(t,e)},x.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},x.keys=function(e){if(!x.isObject(e))return[];if(E)return E(e);var t=[];for(var n in e)x.has(e,n)&&t.push(n);return t},x.values=function(e){var t=x.keys(e),n=t.length,r=new Array(n);for(var i=0;i<n;i++)r[i]=e[t[i]];return r},x.pairs=function(e){var t=x.keys(e),n=t.length,r=new Array(n);for(var i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},x.invert=function(e){var t={},n=x.keys(e);for(var r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]===void 0&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var s=n.length;while(s--)if(n[s]==e)return r[s]==t;var o=e.constructor,u=t.constructor;if(o!==u&&!(x.isFunction(o)&&o instanceof o&&x.isFunction(u)&&u instanceof u)&&"constructor"in e&&"constructor"in t)return!1;n.push(e),r.push(t);var a=0,l=!0;if(i=="[object Array]"){a=e.length,l=a==t.length;if(l)while(a--)if(!(l=M(e[a],t[a],n,r)))break}else{for(var c in e)if(x.has(e,c)){a++;if(!(l=x.has(t,c)&&M(e[c],t[c],n,r)))break}if(l){for(c in t)if(x.has(t,c)&&!(a--))break;l=!a}}return n.pop(),r.pop(),l};x.isEqual=function(e,t){return M(e,t,[],[])},x.isEmpty=function(e){if(e==null)return!0;if(x.isArray(e)||x.isString(e))return e.length===0;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&e.nodeType===1},x.isArray=w||function(e){return f.call(e)=="[object Array]"},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),typeof /./!="function"&&(x.isFunction=function(e){return typeof e=="function"}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||f.call(e)=="[object Boolean]"},x.isNull=function(e){return e===null},x.isUndefined=function(e){return e===void 0},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.constant=function(e){return function(){return e}},x.property=function(e){return function(t){return t[e]}},x.matches=function(e){return function(t){if(t===e)return!0;for(var n in e)if(e[n]!==t[n])return!1;return!0}},x.times=function(e,t,n){var r=Array(Math.max(0,e));for(var i=0;i<e;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},x.now=Date.now||function(){return(new Date).getTime()};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};_.unescape=x.invert(_.escape);var D={escape:new RegExp("["+x.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(_.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return t==null?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),x.result=function(e,t){if(e==null)return void 0;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(x,e))}})};var P=0;x.uniqueId=function(e){var t=++P+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){var r;n=x.defaults({},n,x.templateSettings);var i=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(j,function(e){return"\\"+B[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,x);var a=function(e){return r.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},x.chain=function(e){return x(e).chain()};var F=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e=="shift"||e=="splice")&&n.length===0&&delete n[0],F.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),typeof define=="function"&&define.amd&&define("underscore",[],function(){return x})}).call(this);
/**
 * Flotr2 (c) 2012 Carl Sutherland
 * MIT License
 * Special thanks to:
 * Flotr: http://code.google.com/p/flotr/ (fork)
 * Flot: https://github.com/flot/flot (original fork)
 */
(function(e,t){var n,r;if(typeof exports=="object"&&typeof module=="object")module.exports=e(require("../lib/underscore"));else{if(typeof define=="function"&&define.amd)return define(["underscore"],e);n=t.Flotr}t.Flotr=r=e(_),t.Flotr.noConflict=function(){return t.Flotr=n,r}})(function(e){"use strict";var t;return t={isIphone:/iphone/i.test(navigator.userAgent),isIE:navigator.appVersion.indexOf("MSIE")!=-1?parseFloat(navigator.appVersion.split("MSIE")[1]):!1,graphTypes:{},plugins:{},addType:function(e,n){t.graphTypes[e]=n,t.defaultOptions[e]=n.options||{},t.defaultOptions.defaultType=t.defaultOptions.defaultType||e},addPlugin:function(e,n){t.plugins[e]=n,t.defaultOptions[e]=n.options||{}},draw:function(e,n,r,i){return i=i||t.Graph,new i(e,n,r)},merge:function(n,r){var i,s,o=r||{};for(i in n)s=n[i],s&&typeof s=="object"?s.constructor===Array?o[i]=e.clone(s):s.constructor!==RegExp&&!e.isElement(s)&&!s.jquery?o[i]=t.merge(s,r?r[i]:undefined):o[i]=s:o[i]=s;return o},clone:function(e){return t.merge(e,{})},getTickSize:function(e,n,r,i){var s=(r-n)/e,o=t.getMagnitude(s),u=10,a=s/o;return a<1.5?u=1:a<2.25?u=2:a<3?u=i===0?2:2.5:a<7.5&&(u=5),u*o},defaultTickFormatter:function(e,t){return e+""},defaultTrackFormatter:function(e){return"("+e.x+", "+e.y+")"},engineeringNotation:function(e,t,n){var r=["Y","Z","E","P","T","G","M","k",""],i=["y","z","a","f","p","n","µ","m",""],s=r.length;n=n||1e3,t=Math.pow(10,t||2);if(e===0)return 0;if(e>1)while(s--&&e>=n)e/=n;else{r=i,s=r.length;while(s--&&e<1)e*=n}return Math.round(e*t)/t+r[s]},getMagnitude:function(e){return Math.pow(10,Math.floor(Math.log(e)/Math.LN10))},toPixel:function(e){return Math.floor(e)+.5},toRad:function(e){return-e*(Math.PI/180)},floorInBase:function(e,t){return t*Math.floor(e/t)},drawText:function(n,r,i,s,o){if(!n.fillText){n.drawText(r,i,s,o);return}o=e.extend({size:t.defaultOptions.fontSize,color:"#000000",textAlign:"left",textBaseline:"bottom",weight:1,angle:0},o),n.save(),n.translate(i,s),n.rotate(o.angle),n.fillStyle=o.color,n.font=(o.weight>1?"bold ":"")+o.size*1.3+"px sans-serif",n.textAlign=o.textAlign,n.textBaseline=o.textBaseline,n.fillText(r,0,0),n.restore()},getBestTextAlign:function(e,n){return n=n||{textAlign:"center",textBaseline:"middle"},e+=t.getTextAngleFromAlign(n),Math.abs(Math.cos(e))>.01&&(n.textAlign=Math.cos(e)>0?"right":"left"),Math.abs(Math.sin(e))>.01&&(n.textBaseline=Math.sin(e)>0?"top":"bottom"),n},alignTable:{"right middle":0,"right top":Math.PI/4,"center top":Math.PI/2,"left top":3*(Math.PI/4),"left middle":Math.PI,"left bottom":-3*(Math.PI/4),"center bottom":-Math.PI/2,"right bottom":-Math.PI/4,"center middle":0},getTextAngleFromAlign:function(e){return t.alignTable[e.textAlign+" "+e.textBaseline]||0}},t},this),function(e){var t,n;if(typeof exports=="object"&&typeof module=="object")module.exports=e();else{if(typeof define=="function"&&define.amd)return define([],e);Flotr.defaultOptions=e()}}(function(){"use strict";return{colors:["#00A8F0","#C0D800","#CB4B4B","#4DA74D","#9440ED"],ieBackgroundColor:"#FFFFFF",title:null,subtitle:null,shadowSize:4,defaultType:null,HtmlText:!0,fontColor:"#545454",fontSize:7.5,resolution:1,parseFloat:!0,preventDefault:!0,xaxis:{ticks:null,minorTicks:null,showLabels:!0,showMinorLabels:!1,labelsAngle:0,title:null,titleAngle:0,noTicks:5,minorTickFreq:null,tickFormatter:Flotr.defaultTickFormatter,tickDecimals:null,min:null,max:null,autoscale:!1,autoscaleMargin:0,color:null,mode:"normal",timeFormat:null,timeMode:"UTC",timeUnit:"millisecond",scaling:"linear",base:Math.E,titleAlign:"center",margin:!0},x2axis:{},yaxis:{ticks:null,minorTicks:null,showLabels:!0,showMinorLabels:!1,labelsAngle:0,title:null,titleAngle:90,noTicks:5,minorTickFreq:null,tickFormatter:Flotr.defaultTickFormatter,tickDecimals:null,min:null,max:null,autoscale:!1,autoscaleMargin:0,color:null,scaling:"linear",base:Math.E,titleAlign:"center",margin:!0},y2axis:{titleAngle:270},grid:{color:"#545454",backgroundColor:null,backgroundImage:null,watermarkAlpha:.4,tickColor:"#DDDDDD",labelMargin:3,verticalLines:!0,minorVerticalLines:null,horizontalLines:!0,minorHorizontalLines:null,outlineWidth:1,outline:"nsew",circular:!1},mouse:{track:!1,trackAll:!1,position:"se",relative:!1,trackFormatter:Flotr.defaultTrackFormatter,margin:5,lineColor:"#FF3F19",trackDecimals:1,sensibility:2,trackY:!0,radius:3,fillColor:null,fillOpacity:.4}}}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("../lib/underscore")):typeof define=="function"&&define.amd?define(["underscore"],e):Flotr.DOM=e(_)}(function(e){"use strict";function t(e){return e&&e.jquery?e[0]:e}return{addClass:function(n,r){n=t(n);var i=n.className?n.className:"";if(e.include(i.split(/\s+/g),r))return;n.className=(i?i+" ":"")+r},create:function(e){return document.createElement(e)},node:function(e){var t=this.create("div"),n;return t.innerHTML=e,n=t.children[0],t.innerHTML="",n},empty:function(e){e=t(e),e.innerHTML=""},remove:function(e){e=t(e),e.parentNode.removeChild(e)},hide:function(e){e=t(e),Flotr.DOM.setStyles(e,{display:"none"})},insert:function(n,r){n=t(n),e.isString(r)?n.innerHTML+=r:e.isElement(r)&&n.appendChild(r)},opacity:function(e,n){e=t(e),e.style.opacity=n},position:function(e,n){return e=t(e),e.offsetParent?(n=this.position(e.offsetParent),n.left+=e.offsetLeft,n.top+=e.offsetTop,n):{left:e.offsetLeft||0,top:e.offsetTop||0}},removeClass:function(n,r){var i=n.className?n.className:"";n=t(n),n.className=e.filter(i.split(/\s+/g),function(e){if(e!=r)return!0}).join(" ")},setStyles:function(n,r){n=t(n),e.each(r,function(e,t){n.style[t]=e})},show:function(e){e=t(e),this.setStyles(e,{display:""})},size:function(e){return e=t(e),{height:e.offsetHeight,width:e.offsetWidth}}}}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("../lib/bean"),require("../lib/underscore")):typeof define=="function"&&define.amd?define(["../lib/bean","underscore"],e):Flotr.EventAdapter=e(bean,_)}(function(e,t){"use strict";return{observe:function(t,n,r){return e.add(t,n,r),this},fire:function(t,n,r){return e.fire(t,n,r),typeof Prototype!="undefined"&&Event.fire(t,n,r),this},stopObserving:function(t,n,r){return e.remove(t,n,r),this},eventPointer:function(e){if(!t.isUndefined(e.touches)&&e.touches.length>0)return{x:e.touches[0].pageX,y:e.touches[0].pageY};if(!t.isUndefined(e.changedTouches)&&e.changedTouches.length>0)return{x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY};if(e.pageX||e.pageY)return{x:e.pageX,y:e.pageY};if(e.clientX||e.clientY){var n=document,r=n.body,i=n.documentElement;return{x:e.clientX+r.scrollLeft+i.scrollLeft,y:e.clientY+r.scrollTop+i.scrollTop}}}}}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("./Flotr"),require("../lib/underscore")):typeof define=="function"&&define.amd?define(["./Flotr","underscore"],e):e(Flotr,_)}(function(e,t){"use strict";function n(e,t,n,r){this.rgba=["r","g","b","a"];var i=4;while(-1<--i)this[this.rgba[i]]=arguments[i]||(i==3?1:0);this.normalize()}var r={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]};n.prototype={scale:function(e,n,r,i){var s=4;while(-1<--s)t.isUndefined(arguments[s])||(this[this.rgba[s]]*=arguments[s]);return this.normalize()},alpha:function(e){return!t.isUndefined(e)&&!t.isNull(e)&&(this.a=e),this.normalize()},clone:function(){return new n(this.r,this.b,this.g,this.a)},limit:function(e,t,n){return Math.max(Math.min(e,n),t)},normalize:function(){var e=this.limit;return this.r=e(parseInt(this.r,10),0,255),this.g=e(parseInt(this.g,10),0,255),this.b=e(parseInt(this.b,10),0,255),this.a=e(this.a,0,1),this},distance:function(e){if(!e)return;e=new n.parse(e);var t=0,r=3;while(-1<--r)t+=Math.abs(this[this.rgba[r]]-e[this.rgba[r]]);return t},toString:function(){return this.a>=1?"rgb("+[this.r,this.g,this.b].join(",")+")":"rgba("+[this.r,this.g,this.b,this.a].join(",")+")"},contrast:function(){var e=1-(.299*this.r+.587*this.g+.114*this.b)/255;return e<.5?"#000000":"#ffffff"}},t.extend(n,{parse:function(e){if(e instanceof n)return e;var t;if(t=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(e))return new n(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16));if(t=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(e))return new n(parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10));if(t=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(e))return new n(parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16));if(t=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return new n(parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10),parseFloat(t[4]));if(t=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(e))return new n(parseFloat(t[1])*2.55,parseFloat(t[2])*2.55,parseFloat(t[3])*2.55);if(t=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return new n(parseFloat(t[1])*2.55,parseFloat(t[2])*2.55,parseFloat(t[3])*2.55,parseFloat(t[4]));var i=(e+"").replace(/^\s*([\S\s]*?)\s*$/,"$1").toLowerCase();return i=="transparent"?new n(255,255,255,0):(t=r[i])?new n(t[0],t[1],t[2]):new n(0,0,0,0)},processColor:function(e,r){var i=r.opacity;if(!e)return"rgba(0, 0, 0, 0)";if(e instanceof n)return e.alpha(i).toString();if(t.isString(e))return n.parse(e).alpha(i).toString();var s=e.colors?e:{colors:e};if(!r.ctx)return t.isArray(s.colors)?n.parse(t.isArray(s.colors[0])?s.colors[0][1]:s.colors[0]).alpha(i).toString():"rgba(0, 0, 0, 0)";s=t.extend({start:"top",end:"bottom"},s),/top/i.test(s.start)&&(r.x1=0),/left/i.test(s.start)&&(r.y1=0),/bottom/i.test(s.end)&&(r.x2=0),/right/i.test(s.end)&&(r.y2=0);var o,u,a,f=r.ctx.createLinearGradient(r.x1,r.y1,r.x2,r.y2);for(o=0;o<s.colors.length;o++)u=s.colors[o],t.isArray(u)?(a=u[0],u=u[1]):a=o/(s.colors.length-1),f.addColorStop(a,n.parse(u).alpha(i));return f}}),e.Color=n}),function(e){if(typeof exports=="object"&&typeof module=="object")module.exports=e();else{if(typeof define=="function"&&define.amd)return define([],e);Flotr.Date=e()}}(function(){"use strict";return{set:function(e,t,n,r){n=n||"UTC",t="set"+(n==="UTC"?"UTC":"")+t,e[t](r)},get:function(e,t,n){return n=n||"UTC",t="get"+(n==="UTC"?"UTC":"")+t,e[t]()},format:function(e,t,n){function s(e){return e+="",e.length==1?"0"+e:e}if(!e)return;var r=this.get,i={h:r(e,"Hours",n).toString(),H:s(r(e,"Hours",n)),M:s(r(e,"Minutes",n)),S:s(r(e,"Seconds",n)),s:r(e,"Milliseconds",n),d:r(e,"Date",n).toString(),m:(r(e,"Month",n)+1).toString(),y:r(e,"FullYear",n).toString(),b:Flotr.Date.monthNames[r(e,"Month",n)]},o=[],u,a=!1;for(var f=0;f<t.length;++f)u=t.charAt(f),a?(o.push(i[u]||u),a=!1):u=="%"?a=!0:o.push(u);return o.join("")},getFormat:function(e,t){var n=Flotr.Date.timeUnits;return e<n.second?"%h:%M:%S.%s":e<n.minute?"%h:%M:%S":e<n.day?t<2*n.day?"%h:%M":"%b %d %h:%M":e<n.month?"%b %d":e<n.year?t<n.year?"%b":"%b %y":"%y"},formatter:function(e,t){var n=t.options,r=Flotr.Date.timeUnits[n.timeUnit],i=new Date(e*r);if(t.options.timeFormat)return Flotr.Date.format(i,n.timeFormat,n.timeMode);var s=(t.max-t.min)*r,o=t.tickSize*Flotr.Date.timeUnits[t.tickUnit];return Flotr.Date.format(i,Flotr.Date.getFormat(o,s),n.timeMode)},generator:function(e){function y(e){t(m,e,o,Flotr.floorInBase(n(m,e,o),h))}var t=this.set,n=this.get,r=this.timeUnits,i=this.spec,s=e.options,o=s.timeMode,u=r[s.timeUnit],a=e.min*u,f=e.max*u,l=(f-a)/s.noTicks,c=[],h=e.tickSize,p,d,v;d=s.tickFormatter===Flotr.defaultTickFormatter?this.formatter:s.tickFormatter;for(v=0;v<i.length-1;++v){var m=i[v][0]*r[i[v][1]];if(l<(m+i[v+1][0]*r[i[v+1][1]])/2&&m>=h)break}h=i[v][0],p=i[v][1],p=="year"&&(h=Flotr.getTickSize(s.noTicks*r.year,a,f,0),h==.5&&(p="month",h=6)),e.tickUnit=p,e.tickSize=h;var g=h*r[p];m=new Date(a);switch(p){case"millisecond":y("Milliseconds");break;case"second":y("Seconds");break;case"minute":y("Minutes");break;case"hour":y("Hours");break;case"month":y("Month");break;case"year":y("FullYear")}g>=r.second&&t(m,"Milliseconds",o,0),g>=r.minute&&t(m,"Seconds",o,0),g>=r.hour&&t(m,"Minutes",o,0),g>=r.day&&t(m,"Hours",o,0),g>=r.day*4&&t(m,"Date",o,1),g>=r.year&&t(m,"Month",o,0);var b=0,w=NaN,E;do{E=w,w=m.getTime(),c.push({v:w/u,label:d(w/u,e)});if(p=="month")if(h<1){t(m,"Date",o,1);var S=m.getTime();t(m,"Month",o,n(m,"Month",o)+1);var x=m.getTime();m.setTime(w+b*r.hour+(x-S)*h),b=n(m,"Hours",o),t(m,"Hours",o,0)}else t(m,"Month",o,n(m,"Month",o)+h);else p=="year"?t(m,"FullYear",o,n(m,"FullYear",o)+h):m.setTime(w+g)}while(w<f&&w!=E);return c},timeUnits:{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,month:2592e6,year:31556952e3},spec:[[1,"millisecond"],[20,"millisecond"],[50,"millisecond"],[100,"millisecond"],[200,"millisecond"],[500,"millisecond"],[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"],[3,"month"],[6,"month"],[1,"year"]],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("./Flotr"),require("../lib/underscore"),require("./DOM")):typeof define=="function"&&define.amd?define(["./Flotr","underscore","./DOM"],e):Flotr.Text=e(Flotr,_,Flotr.DOM)}(function(e,t,n){"use strict";return Text=function(e){this.o=e},Text.prototype={dimensions:function(e,t,n,r){return e?this.o.html?this.html(e,this.o.element,n,r):this.canvas(e,t):{width:0,height:0}},canvas:function(t,n){if(!this.o.textEnabled)return;n=n||{};var r=this.measureText(t,n),i=r.width,s=n.size||e.defaultOptions.fontSize,o=n.angle||0,u=Math.cos(o),a=Math.sin(o),f=2,l=6,c;return c={width:Math.abs(u*i)+Math.abs(a*s)+f,height:Math.abs(a*i)+Math.abs(u*s)+l},c},html:function(e,t,r,i){var s=n.create("div");return n.setStyles(s,{position:"absolute",top:"-10000px"}),n.insert(s,'<div style="'+r+'" class="'+i+' flotr-dummy-div">'+e+"</div>"),n.insert(this.o.element,s),n.size(s)},measureText:function(n,r){var i=this.o.ctx,s;return!i.fillText||e.isIphone&&i.measure?{width:i.measure(n,r)}:(r=t.extend({size:e.defaultOptions.fontSize,weight:1,angle:0},r),i.save(),i.font=(r.weight>1?"bold ":"")+r.size*1.3+"px sans-serif",s=i.measureText(n),i.restore(),s)}},Text}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("./Flotr"),require("../lib/underscore"),require("./DOM"),require("./EventAdapter"),require("./Series"),require("./Text"),require("./Color"),require("./Axis")):typeof define=="function"&&define.amd?define(["./Flotr","underscore","./DOM","./EventAdapter","./Series","./Text","./Color","./Axis"],e):Flotr.Graph=e(Flotr,_,Flotr.DOM,Flotr.EventAdapter,Flotr.Series,Flotr.Text,Flotr.Color,Flotr.Axis)}(function(e,t,n,r,i,s,o,u){"use strict";function f(e,t,n){return r.observe.apply(this,arguments),this._handles.push(arguments),this}var a=function(e,n,o){this._setEl(e),this._initMembers(),this._initPlugins(),r.fire(this.el,"flotr:beforeinit",[this]),this.data=n,this.series=i.getSeries(n),this._initOptions(o),this._initGraphTypes(),this._initCanvas(),this._text=new s({element:this.el,ctx:this.ctx,html:this.options.HtmlText,textEnabled:this.textEnabled}),r.fire(this.el,"flotr:afterconstruct",[this]),this._initEvents(),this.findDataRanges(),this.calculateSpacing(),this.draw(t.bind(function(){r.fire(this.el,"flotr:afterinit",[this])},this))};return a.prototype={destroy:function(){r.fire(this.el,"flotr:destroy"),t.each(this._handles,function(e){r.stopObserving.apply(this,e)}),this._handles=[],this.el.graph=null},observe:f,_observe:f,processColor:function(e,n){var r={x1:0,y1:0,x2:this.plotWidth,y2:this.plotHeight,opacity:1,ctx:this.ctx};return t.extend(r,n),o.processColor(e,r)},findDataRanges:function(){var n=this.axes,r,i,s;t.each(this.series,function(e){s=e.getRange(),s&&(r=e.xaxis,i=e.yaxis,r.datamin=Math.min(s.xmin,r.datamin),r.datamax=Math.max(s.xmax,r.datamax),i.datamin=Math.min(s.ymin,i.datamin),i.datamax=Math.max(s.ymax,i.datamax),r.used=r.used||s.xused,i.used=i.used||s.yused)},this),!n.x.used&&!n.x2.used&&(n.x.used=!0),!n.y.used&&!n.y2.used&&(n.y.used=!0),t.each(n,function(e){e.calculateRange()});var o=t.keys(e.graphTypes),u=!1;t.each(this.series,function(e){if(e.hide)return;t.each(o,function(t){e[t]&&e[t].show&&(this.extendRange(t,e),u=!0)},this),u||this.extendRange(this.options.defaultType,e)},this)},extendRange:function(e,t){this[e].extendRange&&this[e].extendRange(t,t.data,t[e],this[e]),this[e].extendYRange&&this[e].extendYRange(t.yaxis,t.data,t[e],this[e]),this[e].extendXRange&&this[e].extendXRange(t.xaxis,t.data,t[e],this[e])},calculateSpacing:function(){var e=this.axes,n=this.options,r=this.series,i=n.grid!==undefined?n.grid.labelMargin:0,s=this._text,o=e.x,u=e.x2,a=e.y,f=e.y2,l=n.grid!==undefined?n.grid.outlineWidth:0,c,h,p,d;t.each(e,function(e){e.calculateTicks(),e.calculateTextDimensions(s,n)}),d=s.dimensions(n.title,{size:n.fontSize*1.5},"font-size:1em;font-weight:bold;","flotr-title"),this.titleHeight=d.height,d=s.dimensions(n.subtitle,{size:n.fontSize},"font-size:smaller;","flotr-subtitle"),this.subtitleHeight=d.height;for(h=0;h<n.length;++h)r[h].points.show&&(l=Math.max(l,r[h].points.radius+r[h].points.lineWidth/2));var v=this.plotOffset;o.options.margin===!1?(v.bottom=0,v.top=0):o.options.margin===!0?(v.bottom+=(n.grid.circular?0:o.used&&o.options.showLabels?o.maxLabel.height+i:0)+(o.used&&o.options.title?o.titleSize.height+i:0)+l,v.top+=(n.grid.circular?0:u.used&&u.options.showLabels?u.maxLabel.height+i:0)+(u.used&&u.options.title?u.titleSize.height+i:0)+this.subtitleHeight+this.titleHeight+l):(v.bottom=o.options.margin,v.top=o.options.margin),a.options.margin===!1?(v.left=0,v.right=0):a.options.margin===!0?(v.left+=(n.grid.circular?0:a.used&&a.options.showLabels?a.maxLabel.width+i:0)+(a.used&&a.options.title?a.titleSize.width+i:0)+l,v.right+=(n.grid.circular?0:f.used&&f.options.showLabels?f.maxLabel.width+i:0)+(f.used&&f.options.title?f.titleSize.width+i:0)+l):(v.left=a.options.margin,v.right=a.options.margin),v.top=Math.floor(v.top),this.plotWidth=this.canvasWidth-v.left-v.right,this.plotHeight=this.canvasHeight-v.bottom-v.top,o.length=u.length=this.plotWidth,a.length=f.length=this.plotHeight,a.offset=f.offset=this.plotHeight,o.setScale(),u.setScale(),a.setScale(),f.setScale()},draw:function(e){var t=this.ctx,n;r.fire(this.el,"flotr:beforedraw",[this.series,this]);if(this.series.length){t.save(),t.translate(this.plotOffset.left,this.plotOffset.top);for(n=0;n<this.series.length;n++)this.series[n].hide||this.drawSeries(this.series[n]);t.restore(),this.clip()}r.fire(this.el,"flotr:afterdraw",[this.series,this]),e&&e()},drawSeries:function(n){function r(e,t){var n=this.getOptions(e,t);this[t].draw(n)}var i=!1;n=n||this.series,t.each(e.graphTypes,function(e,t){n[t]&&n[t].show&&this[t]&&(i=!0,r.call(this,n,t))},this),i||r.call(this,n,this.options.defaultType)},getOptions:function(t,n){var r=t[n],i=this[n],s=t.xaxis,o=t.yaxis,u={context:this.ctx,width:this.plotWidth,height:this.plotHeight,fontSize:this.options.fontSize,fontColor:this.options.fontColor,textEnabled:this.textEnabled,htmlText:this.options.HtmlText,text:this._text,element:this.el,data:t.data,color:t.color,shadowSize:t.shadowSize,xScale:s.d2p,yScale:o.d2p,xInverse:s.p2d,yInverse:o.p2d};return u=e.merge(r,u),u.fillStyle=this.processColor(r.fillColor||t.color,{opacity:r.fillOpacity}),u},getEventPosition:function(e){var t=document,i=t.body,s=t.documentElement,o=this.axes,u=this.plotOffset,a=this.lastMousePos,f=r.eventPointer(e),l=f.x-a.pageX,c=f.y-a.pageY,h,p,d;return"ontouchstart"in this.el?(h=n.position(this.overlay),p=f.x-h.left-u.left,d=f.y-h.top-u.top):(h=this.overlay.getBoundingClientRect(),p=e.clientX-h.left-u.left-i.scrollLeft-s.scrollLeft,d=e.clientY-h.top-u.top-i.scrollTop-s.scrollTop),{x:o.x.p2d(p),x2:o.x2.p2d(p),y:o.y.p2d(d),y2:o.y2.p2d(d),relX:p,relY:d,dX:l,dY:c,absX:f.x,absY:f.y,pageX:f.x,pageY:f.y}},clickHandler:function(e){if(this.ignoreClick)return this.ignoreClick=!1,this.ignoreClick;r.fire(this.el,"flotr:click",[this.getEventPosition(e),this])},mouseMoveHandler:function(e){if(this.mouseDownMoveHandler)return;var t=this.getEventPosition(e);r.fire(this.el,"flotr:mousemove",[e,t,this]),this.lastMousePos=t},mouseDownHandler:function(e){if(this.mouseUpHandler)return;this.mouseUpHandler=t.bind(function(e){r.stopObserving(document,"mouseup",this.mouseUpHandler),r.stopObserving(document,"mousemove",this.mouseDownMoveHandler),this.mouseDownMoveHandler=null,this.mouseUpHandler=null,r.fire(this.el,"flotr:mouseup",[e,this])},this),this.mouseDownMoveHandler=t.bind(function(t){var n=this.getEventPosition(t);r.fire(this.el,"flotr:mousemove",[e,n,this]),this.lastMousePos=n},this),r.observe(document,"mouseup",this.mouseUpHandler),r.observe(document,"mousemove",this.mouseDownMoveHandler),r.fire(this.el,"flotr:mousedown",[e,this]),this.ignoreClick=!1},drawTooltip:function(e,t,r,i){var s=this.getMouseTrack(),o="opacity:0.7;background-color:#000;color:#fff;display:none;position:absolute;padding:2px 8px;-moz-border-radius:4px;border-radius:4px;white-space:nowrap;",u=i.position,a=i.margin,f=this.plotOffset;t!==null&&r!==null?(i.relative?(u.charAt(0)=="n"?o+="bottom:"+(a-f.top-r+this.canvasHeight)+"px;top:auto;":u.charAt(0)=="s"&&(o+="top:"+(a+f.top+r)+"px;bottom:auto;"),u.charAt(1)=="e"?o+="left:"+(a+f.left+t)+"px;right:auto;":u.charAt(1)=="w"&&(o+="right:"+(a-f.left-t+this.canvasWidth)+"px;left:auto;")):(u.charAt(0)=="n"?o+="top:"+(a+f.top)+"px;bottom:auto;":u.charAt(0)=="s"&&(o+="bottom:"+(a+f.bottom)+"px;top:auto;"),u.charAt(1)=="e"?o+="right:"+(a+f.right)+"px;left:auto;":u.charAt(1)=="w"&&(o+="left:"+(a+f.left)+"px;right:auto;")),s.style.cssText=o,n.empty(s),n.insert(s,e),n.show(s)):n.hide(s)},clip:function(t){var n=this.plotOffset,r=this.canvasWidth,i=this.canvasHeight;t=t||this.ctx;if(e.isIE&&e.isIE<9&&!e.isFlashCanvas){if(t===this.octx)return;t.save(),t.fillStyle=this.processColor(this.options.ieBackgroundColor),t.fillRect(0,0,r,n.top),t.fillRect(0,0,n.left,i),t.fillRect(0,i-n.bottom,r,n.bottom),t.fillRect(r-n.right,0,n.right,i),t.restore()}else t.clearRect(0,0,r,n.top),t.clearRect(0,0,n.left,i),t.clearRect(0,i-n.bottom,r,n.bottom),t.clearRect(r-n.right,0,n.right,i)},_initMembers:function(){this._handles=[],this.lastMousePos={pageX:null,pageY:null},this.plotOffset={left:0,right:0,top:0,bottom:0},this.ignoreClick=!0,this.prevHit=null},_initGraphTypes:function(){t.each(e.graphTypes,function(t,n){this[n]=e.clone(t)},this)},_initEvents:function(){var e=this.el,n,i,s;"ontouchstart"in e?(n=t.bind(function(t){s=!0,r.stopObserving(document,"touchend",n),r.fire(e,"flotr:mouseup",[event,this]),this.multitouches=null,i||this.clickHandler(t)},this),this.observe(this.overlay,"touchstart",t.bind(function(t){i=!1,s=!1,this.ignoreClick=!1,t.touches&&t.touches.length>1&&(this.multitouches=t.touches),r.fire(e,"flotr:mousedown",[event,this]),this.observe(document,"touchend",n)},this)),this.observe(this.overlay,"touchmove",t.bind(function(t){var n=this.getEventPosition(t);this.options.preventDefault&&t.preventDefault(),i=!0,this.multitouches||t.touches&&t.touches.length>1?this.multitouches=t.touches:s||r.fire(e,"flotr:mousemove",[event,n,this]),this.lastMousePos=n},this))):this.observe(this.overlay,"mousedown",t.bind(this.mouseDownHandler,this)).observe(e,"mousemove",t.bind(this.mouseMoveHandler,this)).observe(this.overlay,"click",t.bind(this.clickHandler,this)).observe(e,"mouseout",function(t){r.fire(e,"flotr:mouseout",t)})},_initCanvas:function(){function l(i,s){return i||(i=n.create("canvas"),typeof FlashCanvas!="undefined"&&typeof i.getContext=="function"&&(FlashCanvas.initElement(i),this.isFlashCanvas=!0),i.className="flotr-"+s,i.style.cssText="position:absolute;left:0px;top:0px;",n.insert(e,i)),t.each(a,function(e,t){n.show(i);if(s=="canvas"&&i.getAttribute(t)===e)return;i.setAttribute(t,e*r.resolution),i.style[t]=e+"px"}),i.context_=null,i}function c(e){window.G_vmlCanvasManager&&window.G_vmlCanvasManager.initElement(e);var t=e.getContext("2d");return window.G_vmlCanvasManager||t.scale(r.resolution,r.resolution),t}var e=this.el,r=this.options,i=e.children,s=[],o,u,a,f;for(u=i.length;u--;)o=i[u],!this.canvas&&o.className==="flotr-canvas"?this.canvas=o:!this.overlay&&o.className==="flotr-overlay"?this.overlay=o:s.push(o);for(u=s.length;u--;)e.removeChild(s[u]);n.setStyles(e,{position:"relative"}),a={},a.width=e.clientWidth,a.height=e.clientHeight;if(a.width<=0||a.height<=0||r.resolution<=0)throw"Invalid dimensions for plot, width = "+a.width+", height = "+a.height+", resolution = "+r.resolution;this.canvas=l(this.canvas,"canvas"),this.overlay=l(this.overlay,"overlay"),this.ctx=c(this.canvas),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.octx=c(this.overlay),this.octx.clearRect(0,0,this.overlay.width,this.overlay.height),this.canvasHeight=a.height,this.canvasWidth=a.width,this.textEnabled=!!this.ctx.drawText||!!this.ctx.fillText},_initPlugins:function(){t.each(e.plugins,function(n,r){t.each(n.callbacks,function(e,n){this.observe(this.el,n,t.bind(e,this))},this),this[r]=e.clone(n),t.each(this[r],function(e,n){t.isFunction(e)&&(this[r][n]=t.bind(e,this))},this)},this)},_initOptions:function(n){var i=e.clone(e.defaultOptions);i.x2axis=t.extend(t.clone(i.xaxis),i.x2axis),i.y2axis=t.extend(t.clone(i.yaxis),i.y2axis),this.options=e.merge(n||{},i),this.options.grid!==undefined&&(this.options.grid.minorVerticalLines===null&&this.options.xaxis.scaling==="logarithmic"&&(this.options.grid.minorVerticalLines=!0),this.options.grid.minorHorizontalLines===null&&this.options.yaxis.scaling==="logarithmic"&&(this.options.grid.minorHorizontalLines=!0)),r.fire(this.el,"flotr:afterinitoptions",[this]),this.axes=u.getAxes(this.options);var s=[],a=[],f=this.series.length,l=this.series.length,c=this.options.colors,h=[],p=0,d,v,m,g;for(v=l-1;v>-1;--v)d=this.series[v].color,d&&(--l,t.isNumber(d)?s.push(d):h.push(o.parse(d)));for(v=s.length-1;v>-1;--v)l=Math.max(l,s[v]+1);for(v=0;a.length<l;){d=c.length==v?new o(100,100,100):o.parse(c[v]);var y=p%2==1?-1:1,b=1+y*Math.ceil(p/2)*.2;d.scale(b,b,b),a.push(d),++v>=c.length&&(v=0,++p)}for(v=0,m=0;v<f;++v){g=this.series[v],g.color?t.isNumber(g.color)&&(g.color=a[g.color].toString()):g.color=a[m++].toString(),g.xaxis||(g.xaxis=this.axes.x),g.xaxis==1?g.xaxis=this.axes.x:g.xaxis==2&&(g.xaxis=this.axes.x2),g.yaxis||(g.yaxis=this.axes.y),g.yaxis==1?g.yaxis=this.axes.y:g.yaxis==2&&(g.yaxis=this.axes.y2);for(var w in e.graphTypes)g[w]=t.extend(t.clone(this.options[w]),g[w]);g.mouse=t.extend(t.clone(this.options.mouse),g.mouse),t.isUndefined(g.shadowSize)&&(g.shadowSize=this.options.shadowSize)}},_setEl:function(e){if(!e)throw"The target container doesn't exist";if(e.graph instanceof a)e.graph.destroy();else if(!e.clientWidth)throw"The target container must be visible";e.graph=this,this.el=e}},a}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("./Flotr"),require("../lib/underscore")):typeof define=="function"&&define.amd?define(["./Flotr","underscore"],e):Flotr.Axis=e(Flotr,_)}(function(e,t){"use strict";function r(e){this.orientation=1,this.offset=0,this.datamin=Number.MAX_VALUE,this.datamax=-Number.MAX_VALUE,t.extend(this,e)}function s(e,t){return e=Math.log(Math.max(e,Number.MIN_VALUE)),t!==Math.E&&(e/=Math.log(t)),e}function o(e,t){return t===Math.E?Math.exp(e):Math.pow(t,e)}var n="logarithmic";return r.prototype={setScale:function(){var e=this.length,t=this.max,r=this.min,i=this.offset,u=this.orientation,a=this.options,f=a.scaling===n,l;f?l=e/(s(t,a.base)-s(r,a.base)):l=e/(t-r),this.scale=l,f?(this.d2p=function(e){return i+u*(s(e,a.base)-s(r,a.base))*l},this.p2d=function(e){return o((i+u*e)/l+s(r,a.base),a.base)}):(this.d2p=function(e){return i+u*(e-r)*l},this.p2d=function(e){return(i+u*e)/l+r})},calculateTicks:function(){var e=this.options;this.ticks=[],this.minorTicks=[],e.ticks?(this._cleanUserTicks(e.ticks,this.ticks),this._cleanUserTicks(e.minorTicks||[],this.minorTicks)):e.mode=="time"?this._calculateTimeTicks():e.scaling==="logarithmic"?this._calculateLogTicks():this._calculateTicks(),t.each(this.ticks,function(e){e.label+=""}),t.each(this.minorTicks,function(e){e.label+=""})},calculateRange:function(){if(!this.used)return;var t=this,n=t.options,r=n.min!==null?n.min:t.datamin,i=n.max!==null?n.max:t.datamax,s=n.autoscaleMargin;n.scaling=="logarithmic"&&(r<=0&&(r=t.datamin),i<=0&&(i=r));if(i==r){var o=i?.01:1;n.min===null&&(r-=o),n.max===null&&(i+=o)}if(n.scaling==="logarithmic"){r<0&&(r=i/n.base);var u=Math.log(i);n.base!=Math.E&&(u/=Math.log(n.base)),u=Math.ceil(u);var a=Math.log(r);n.base!=Math.E&&(a/=Math.log(n.base)),a=Math.ceil(a),t.tickSize=e.getTickSize(n.noTicks,a,u,n.tickDecimals===null?0:n.tickDecimals),n.minorTickFreq===null&&(u-a>10?n.minorTickFreq=0:u-a>5?n.minorTickFreq=2:n.minorTickFreq=5)}else t.tickSize=e.getTickSize(n.noTicks,r,i,n.tickDecimals);t.min=r,t.max=i,n.min===null&&n.autoscale&&(t.min-=t.tickSize*s,t.min<0&&t.datamin>=0&&(t.min=0),t.min=t.tickSize*Math.floor(t.min/t.tickSize)),n.max===null&&n.autoscale&&(t.max+=t.tickSize*s,t.max>0&&t.datamax<=0&&t.datamax!=t.datamin&&(t.max=0),t.max=t.tickSize*Math.ceil(t.max/t.tickSize)),t.min==t.max&&(t.max=t.min+1)},calculateTextDimensions:function(t,n){var r="",i,s;if(this.options.showLabels)for(s=0;s<this.ticks.length;++s)i=this.ticks[s].label.length,i>r.length&&(r=this.ticks[s].label);this.maxLabel=t.dimensions(r,{size:n.fontSize,angle:e.toRad(this.options.labelsAngle)},"font-size:smaller;","flotr-grid-label"),this.titleSize=t.dimensions(this.options.title,{size:n.fontSize*1.2,angle:e.toRad(this.options.titleAngle)},"font-weight:bold;","flotr-axis-title")},_cleanUserTicks:function(e,n){var r=this,i=this.options,s,o,u,a;t.isFunction(e)&&(e=e({min:r.min,max:r.max}));for(o=0;o<e.length;++o)a=e[o],typeof a=="object"?(s=a[0],u=a.length>1?a[1]:i.tickFormatter(s,{min:r.min,max:r.max})):(s=a,u=i.tickFormatter(s,{min:this.min,max:this.max})),n[o]={v:s,label:u}},_calculateTimeTicks:function(){this.ticks=e.Date.generator(this)},_calculateLogTicks:function(){var e=this,t=e.options,n,r,s=Math.log(e.max);t.base!=Math.E&&(s/=Math.log(t.base)),s=Math.ceil(s);var o=Math.log(e.min);t.base!=Math.E&&(o/=Math.log(t.base)),o=Math.ceil(o);for(i=o;i<s;i+=e.tickSize){r=t.base==Math.E?Math.exp(i):Math.pow(t.base,i);var u=r*(t.base==Math.E?Math.exp(e.tickSize):Math.pow(t.base,e.tickSize)),a=(u-r)/t.minorTickFreq;e.ticks.push({v:r,label:t.tickFormatter(r,{min:e.min,max:e.max})});for(n=r+a;n<u;n+=a)e.minorTicks.push({v:n,label:t.tickFormatter(n,{min:e.min,max:e.max})})}r=t.base==Math.E?Math.exp(i):Math.pow(t.base,i),e.ticks.push({v:r,label:t.tickFormatter(r,{min:e.min,max:e.max})})},_calculateTicks:function(){var e=this,t=e.options,n=e.tickSize,r=e.min,i=e.max,s=n*Math.ceil(r/n),o,u,a,f,l,c;t.minorTickFreq&&(u=n/t.minorTickFreq);for(l=0;(a=f=s+l*n)<=i;++l){o=t.tickDecimals,o===null&&(o=1-Math.floor(Math.log(n)/Math.LN10)),o<0&&(o=0),a=a.toFixed(o),e.ticks.push({v:a,label:t.tickFormatter(a,{min:e.min,max:e.max})});if(t.minorTickFreq)for(c=0;c<t.minorTickFreq&&l*n+c*u<i;++c)a=f+c*u,e.minorTicks.push({v:a,label:t.tickFormatter(a,{min:e.min,max:e.max})})}}},t.extend(r,{getAxes:function(e){return{x:new r({options:e.xaxis,n:1,length:this.plotWidth}),x2:new r({options:e.x2axis,n:2,length:this.plotWidth}),y:new r({options:e.yaxis,n:1,length:this.plotHeight,offset:this.plotHeight,orientation:-1}),y2:new r({options:e.y2axis,n:2,length:this.plotHeight,offset:this.plotHeight,orientation:-1})}}}),r}),function(e){if(typeof exports=="object"&&typeof module=="object")module.exports=e(require("../lib/underscore"));else{if(typeof define=="function"&&define.amd)return define(["underscore"],e);Flotr.Series=e(_)}}(function(e){"use strict";function t(t){e.extend(this,t)}return t.prototype={getRange:function(){var e=this.data,t=e.length,n=Number.MAX_VALUE,r=Number.MAX_VALUE,i=-Number.MAX_VALUE,s=-Number.MAX_VALUE,o=!1,u=!1,a,f,l;if(t<0||this.hide)return!1;for(l=0;l<t;l++)a=e[l][0],f=e[l][1],a!==null&&(a<n&&(n=a,o=!0),a>i&&(i=a,o=!0)),f!==null&&(f<r&&(r=f,u=!0),f>s&&(s=f,u=!0));return{xmin:n,xmax:i,ymin:r,ymax:s,xused:o,yused:u}}},e.extend(t,{getSeries:function(n){return e.map(n,function(n){var r;return n.data?(r=new t,e.extend(r,n)):r=new t({data:n}),r})}}),t}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("./Flotr")):typeof define=="function"&&define.amd?define(["./Flotr"],e):e(Flotr)}(function(e){"use strict";e.addType("lines",{options:{show:!1,lineWidth:2,fill:!1,fillBorder:!1,fillColor:null,fillOpacity:.4,steps:!1,stacked:!1},stack:{values:[]},draw:function(e){var t=e.context,n=e.lineWidth,r=e.shadowSize,i;t.save(),t.lineJoin="round",r&&(t.lineWidth=r/2,i=n/2+t.lineWidth/2,t.strokeStyle="rgba(0,0,0,0.1)",this.plot(e,i+r/2,!1),t.strokeStyle="rgba(0,0,0,0.2)",this.plot(e,i,!1)),t.lineWidth=n,t.strokeStyle=e.color,this.plot(e,0,!0),t.restore()},plot:function(e,t,n){function S(){!t&&e.fill&&d&&(v=o(d[0]),r.fillStyle=e.fillStyle,r.lineTo(m,p),r.lineTo(v,p),r.lineTo(v,u(d[1])),r.fill(),e.fillBorder&&r.stroke())}var r=e.context,i=e.width,s=e.height,o=e.xScale,u=e.yScale,a=e.data,f=e.stacked?this.stack:!1,l=a.length-1,c=null,h=null,p=u(0),d=null,v,m,g,y,b,w,E;if(l<1)return;r.beginPath();for(E=0;E<l;++E){if(a[E][1]===null||a[E+1][1]===null){e.fill&&E>0&&a[E][1]!==null&&(r.stroke(),S(),d=null,r.closePath(),r.beginPath());continue}v=o(a[E][0]),m=o(a[E+1][0]),d===null&&(d=a[E]),f?(b=f.values[a[E][0]]||0,w=f.values[a[E+1][0]]||f.values[a[E][0]]||0,g=u(a[E][1]+b),y=u(a[E+1][1]+w),n&&(a[E].y0=b,f.values[a[E][0]]=a[E][1]+b,E==l-1&&(a[E+1].y0=w,f.values[a[E+1][0]]=a[E+1][1]+w))):(g=u(a[E][1]),y=u(a[E+1][1]));if(g>s&&y>s||g<0&&y<0||v<0&&m<0||v>i&&m>i)continue;(c!=v||h!=g+t)&&r.moveTo(v,g+t),c=m,h=y+t,e.steps?(r.lineTo(c+t/2,g+t),r.lineTo(c+t/2,h)):r.lineTo(c,h)}(!e.fill||e.fill&&!e.fillBorder)&&r.stroke(),S(),r.closePath()},extendYRange:function(e,t,n,r){var i=e.options;if(n.stacked&&(!i.max&&i.max!==0||!i.min&&i.min!==0)){var s=e.max,o=e.min,u=r.positiveSums||{},a=r.negativeSums||{},f,l;for(l=0;l<t.length;l++)f=t[l][0]+"",t[l][1]>0?(u[f]=(u[f]||0)+t[l][1],s=Math.max(s,u[f])):(a[f]=(a[f]||0)+t[l][1],o=Math.min(o,a[f]));r.negativeSums=a,r.positiveSums=u,e.max=s,e.min=o}n.steps&&(this.hit=function(e){var t=e.data,n=e.args,r=e.yScale,i=n[0],s=t.length,o=n[1],u=e.xInverse(i.relX),a=i.relY,f;for(f=0;f<s-1;f++)if(u>=t[f][0]&&u<=t[f+1][0]){Math.abs(r(t[f][1])-a)<8&&(o.x=t[f][0],o.y=t[f][1],o.index=f,o.seriesIndex=e.index);break}},this.drawHit=function(e){var t=e.context,n=e.args,r=e.data,i=e.xScale,s=n.index,o=i(n.x),u=e.yScale(n.y),a;r.length-1>s&&(a=e.xScale(r[s+1][0]),t.save(),t.strokeStyle=e.color,t.lineWidth=e.lineWidth,t.beginPath(),t.moveTo(o,u),t.lineTo(a,u),t.stroke(),t.closePath(),t.restore())},this.clearHit=function(e){var t=e.context,n=e.args,r=e.data,i=e.xScale,s=e.lineWidth,o=n.index,u=i(n.x),a=e.yScale(n.y),f;r.length-1>o&&(f=e.xScale(r[o+1][0]),t.clearRect(u-s,a-s,f-u+2*s,2*s))})}})}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("./Flotr")):typeof define=="function"&&define.amd?define(["./Flotr"],e):e(Flotr)}(function(e){"use strict";e.addType("bars",{options:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,fillOpacity:.4,horizontal:!1,stacked:!1,centered:!0,topPadding:.1,grouped:!1},stack:{positive:[],negative:[],_positive:[],_negative:[]},draw:function(e){var t=e.context;this.current+=1,t.save(),t.lineJoin="miter",t.lineWidth=e.lineWidth,t.strokeStyle=e.color,e.fill&&(t.fillStyle=e.fillStyle),this.plot(e),t.restore()},plot:function(e){var t=e.data,n=e.context,r=e.shadowSize,i,s,o,u,a,f;if(t.length<1)return;this.translate(n,e.horizontal);for(i=0;i<t.length;i++){s=this.getBarGeometry(t[i][0],t[i][1],e);if(s===null)continue;o=s.left,u=s.top,a=s.width,f=s.height,e.fill&&n.fillRect(o,u,a,f),r&&(n.save(),n.fillStyle="rgba(0,0,0,0.05)",n.fillRect(o+r,u+r,a,f),n.restore()),e.lineWidth&&n.strokeRect(o,u,a,f)}},translate:function(e,t){t&&(e.rotate(-Math.PI/2),e.scale(-1,1))},getBarGeometry:function(e,t,n){var r=n.horizontal,i=n.barWidth,s=n.centered,o=n.stacked?this.stack:!1,u=n.lineWidth,a=s?i/2:0,f=r?n.yScale:n.xScale,l=r?n.xScale:n.yScale,c=r?t:e,h=r?e:t,p=0,d,v,m,g,y;return n.grouped&&(this.current/this.groups,c-=a,i/=this.groups,a=i/2,c=c+i*this.current-a),o&&(d=h>0?o.positive:o.negative,p=d[c]||p,d[c]=p+h),v=f(c-a),m=f(c+i-a),g=l(h+p),y=l(p),y<0&&(y=0),e===null||t===null?null:{x:c,y:h,xScale:f,yScale:l,top:g,left:Math.min(v,m)-u/2,width:Math.abs(m-v)-u,height:y-g}},hit:function(e){var t=e.data,n=e.args,r=n[0],i=n[1],s=e.xInverse(r.relX),o=e.yInverse(r.relY),u=this.getBarGeometry(s,o,e),a=u.width/2,f=u.left,l=u.y,c,h;for(h=t.length;h--;)c=this.getBarGeometry(t[h][0],t[h][1],e),(l>0&&l<c.y||l<0&&l>c.y)&&Math.abs(f-c.left)<a&&(i.x=t[h][0],i.y=t[h][1],i.index=h,i.seriesIndex=e.index)},drawHit:function(e){var t=e.context,n=e.args,r=this.getBarGeometry(n.x,n.y,e),i=r.left,s=r.top,o=r.width,u=r.height;t.save(),t.strokeStyle=e.color,t.lineWidth=e.lineWidth,this.translate(t,e.horizontal),t.beginPath(),t.moveTo(i,s+u),t.lineTo(i,s),t.lineTo(i+o,s),t.lineTo(i+o,s+u),e.fill&&(t.fillStyle=e.fillStyle,t.fill()),t.stroke(),t.closePath(),t.restore()},clearHit:function(e){var t=e.context,n=e.args,r=this.getBarGeometry(n.x,n.y,e),i=r.left,s=r.width,o=r.top,u=r.height,a=2*e.lineWidth;t.save(),this.translate(t,e.horizontal),t.clearRect(i-a,Math.min(o,o+u)-a,s+2*a,Math.abs(u)+2*a),t.restore()},extendXRange:function(e,t,n,r){this._extendRange(e,t,n,r),this.groups=this.groups+1||1,this.current=0},extendYRange:function(e,t,n,r){this._extendRange(e,t,n,r)},_extendRange:function(e,t,n,r){var i=e.options.max;if(_.isNumber(i)||_.isString(i))return;var s=e.min,o=e.max,u=n.horizontal,a=e.orientation,f=this.positiveSums||{},l=this.negativeSums||{},c,h,p,d;(a==1&&!u||a==-1&&u)&&n.centered&&(o=Math.max(e.datamax+n.barWidth,o),s=Math.min(e.datamin-n.barWidth,s));if(n.stacked&&(a==1&&u||a==-1&&!u))for(d=t.length;d--;)c=t[d][a==1?1:0]+"",h=t[d][a==1?0:1],h>0?(f[c]=(f[c]||0)+h,o=Math.max(o,f[c])):(l[c]=(l[c]||0)+h,s=Math.min(s,l[c]));(a==1&&u||a==-1&&!u)&&n.topPadding&&(e.max===e.datamax||n.stacked&&this.stackMax!==o)&&(o+=n.topPadding*(o-s)),this.stackMin=s,this.stackMax=o,this.negativeSums=l,this.positiveSums=f,e.max=o,e.min=s}})}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("./Flotr")):typeof define=="function"&&define.amd?define(["./Flotr"],e):e(Flotr)}(function(e){"use strict";function t(e){return typeof e=="object"&&e.constructor&&(Image?!0:e.constructor===Image)}e.defaultMarkerFormatter=function(e){return Math.round(e.y*100)/100+""},e.addType("markers",{options:{show:!1,lineWidth:1,color:"#000000",fill:!1,fillColor:"#FFFFFF",fillOpacity:.4,stroke:!1,position:"ct",verticalMargin:0,labelFormatter:e.defaultMarkerFormatter,fontSize:e.defaultOptions.fontSize,stacked:!1,stackingType:"b",horizontal:!1},stack:{positive:[],negative:[],values:[]},draw:function(e){function h(e,t){return o=r.negative[e]||0,s=r.positive[e]||0,t>0?(r.positive[e]=o+t,o+t):(r.negative[e]=s+t,s+t)}var t=e.data,n=e.context,r=e.stacked?e.stack:!1,i=e.stackingType,s,o,u,a,f,l,c;n.save(),n.lineJoin="round",n.lineWidth=e.lineWidth,n.strokeStyle="rgba(0,0,0,0.5)",n.fillStyle=e.fillStyle;for(a=0;a<t.length;++a)f=t[a][0],l=t[a][1],r&&(i=="b"?e.horizontal?l=h(l,f):f=h(f,l):i=="a"&&(u=r.values[f]||0,r.values[f]=u+l,l=u+l)),c=e.labelFormatter({x:f,y:l,index:a,data:t}),this.plot(e.xScale(f),e.yScale(l),c,e);n.restore()},plot:function(e,n,r,i){var s=i.context;if(t(r)&&!r.complete)throw"Marker image not loaded.";this._plot(e,n,r,i)},_plot:function(n,r,i,s){var o=s.context,u=2,a=n,f=r,l;t(i)?l={height:i.height,width:i.width}:l=s.text.canvas(i),l.width=Math.floor(l.width+u*2),l.height=Math.floor(l.height+u*2),s.position.indexOf("c")!=-1?a-=l.width/2+u:s.position.indexOf("l")!=-1&&(a-=l.width),s.position.indexOf("m")!=-1?f-=l.height/2+u:s.position.indexOf("t")!=-1?f-=l.height+s.verticalMargin:f+=s.verticalMargin,a=Math.floor(a)+.5,f=Math.floor(f)+.5,s.fill&&o.fillRect(a,f,l.width,l.height),s.stroke&&o.strokeRect(a,f,l.width,l.height),t(i)?o.drawImage(i,parseInt(a+u,10),parseInt(f+u,10)):e.drawText(o,i,a+u,f+u,{textBaseline:"top",textAlign:"left",size:s.fontSize,color:s.color})}})}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("./Flotr")):typeof define=="function"&&define.amd?define(["./Flotr"],e):e(Flotr)}(function(e){"use strict";e.addType("points",{options:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#FFFFFF",fillOpacity:1,hitRadius:null},draw:function(e){var t=e.context,n=e.lineWidth,r=e.shadowSize;t.save(),r>0&&(t.lineWidth=r/2,t.strokeStyle="rgba(0,0,0,0.1)",this.plot(e,r/2+t.lineWidth/2),t.strokeStyle="rgba(0,0,0,0.2)",this.plot(e,t.lineWidth/2)),t.lineWidth=e.lineWidth,t.strokeStyle=e.color,e.fill&&(t.fillStyle=e.fillStyle),this.plot(e),t.restore()},plot:function(e,t){var n=e.data,r=e.context,i=e.xScale,s=e.yScale,o,u,a;for(o=n.length-1;o>-1;--o){a=n[o][1];if(a===null)continue;u=i(n[o][0]),a=s(a);if(u<0||u>e.width||a<0||a>e.height)continue;r.beginPath(),t?r.arc(u,a+t,e.radius,0,Math.PI,!1):(r.arc(u,a,e.radius,0,2*Math.PI,!0),e.fill&&r.fill()),r.stroke(),r.closePath()}}})}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("./Flotr"),require("../lib/underscore"),require("./DOM"),require("./EventAdapter")):typeof define=="function"&&define.amd?define(["./Flotr","underscore","./DOM","./EventAdapter"],e):e(Flotr,_,Flotr.DOM,Flotr.EventAdapter)}(function(e,t,n,r){"use strict";e.addPlugin("graphGrid",{callbacks:{"flotr:beforedraw":function(){this.graphGrid.drawGrid()},"flotr:afterdraw":function(){this.graphGrid.drawOutline()}},drawGrid:function(){function v(t){for(p=0;p<t.length;++p){var n=t[p].v/c.max;for(d=0;d<=w;++d)e[d===0?"moveTo":"lineTo"](Math.cos(d*S+x)*b*n,Math.sin(d*S+x)*b*n)}}function m(n,r){t.each(t.pluck(n,"v"),function(t){if(t<=c.min||t>=c.max||(t==c.min||t==c.max)&&i.outlineWidth)return;r(Math.floor(c.d2p(t))+e.lineWidth/2)})}function g(t){e.moveTo(t,0),e.lineTo(t,f)}function y(t){e.moveTo(0,t),e.lineTo(l,t)}var e=this.ctx,n=this.options,i=n.grid,s=i.verticalLines,o=i.horizontalLines,u=i.minorVerticalLines,a=i.minorHorizontalLines,f=this.plotHeight,l=this.plotWidth,c,h,p,d;(s||u||o||a)&&r.fire(this.el,"flotr:beforegrid",[this.axes.x,this.axes.y,n,this]),e.save(),e.lineWidth=1,e.strokeStyle=i.tickColor;if(i.circular){e.translate(this.plotOffset.left+l/2,this.plotOffset.top+f/2);var b=Math.min(f,l)*n.radar.radiusRatio/2,w=this.axes.x.ticks.length,S=2*(Math.PI/w),x=-Math.PI/2;e.beginPath(),c=this.axes.y,o&&v(c.ticks),a&&v(c.minorTicks),s&&t.times(w,function(t){e.moveTo(0,0),e.lineTo(Math.cos(t*S+x)*b,Math.sin(t*S+x)*b)}),e.stroke()}else e.translate(this.plotOffset.left,this.plotOffset.top),i.backgroundColor&&(e.fillStyle=this.processColor(i.backgroundColor,{x1:0,y1:0,x2:l,y2:f}),e.fillRect(0,0,l,f)),e.beginPath(),c=this.axes.x,s&&m(c.ticks,g),u&&m(c.minorTicks,g),c=this.axes.y,o&&m(c.ticks,y),a&&m(c.minorTicks,y),e.stroke();e.restore(),(s||u||o||a)&&r.fire(this.el,"flotr:aftergrid",[this.axes.x,this.axes.y,n,this])},drawOutline:function(){var e=this,t=e.options,n=t.grid,r=n.outline,i=e.ctx,s=n.backgroundImage,o=e.plotOffset,u=o.left,a=o.top,f=e.plotWidth,l=e.plotHeight,c,h,p,d,v,m,g;if(!n.outlineWidth)return;i.save();if(n.circular){i.translate(u+f/2,a+l/2);var y=Math.min(l,f)*t.radar.radiusRatio/2,b=this.axes.x.ticks.length,w=2*(Math.PI/b),E=-Math.PI/2;i.beginPath(),i.lineWidth=n.outlineWidth,i.strokeStyle=n.color,i.lineJoin="round";for(g=0;g<=b;++g)i[g===0?"moveTo":"lineTo"](Math.cos(g*w+E)*y,Math.sin(g*w+E)*y);i.stroke()}else{i.translate(u,a);var S=n.outlineWidth,x=.5-S+(S+1)%2/2,T="lineTo",N="moveTo";i.lineWidth=S,i.strokeStyle=n.color,i.lineJoin="miter",i.beginPath(),i.moveTo(x,x),f-=S/2%1,l+=S/2,i[r.indexOf("n")!==-1?T:N](f,x),i[r.indexOf("e")!==-1?T:N](f,l),i[r.indexOf("s")!==-1?T:N](x,l),i[r.indexOf("w")!==-1?T:N](x,x),i.stroke(),i.closePath()}i.restore(),s&&(p=s.src||s,d=(parseInt(s.left,10)||0)+o.left,v=(parseInt(s.top,10)||0)+o.top,h=new Image,h.onload=function(){i.save(),s.alpha&&(i.globalAlpha=s.alpha),i.globalCompositeOperation="destination-over",i.drawImage(h,0,0,h.width,h.height,d,v,f,l),i.restore()},h.src=p)}})}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("./Flotr"),require("./DOM")):typeof define=="function"&&define.amd?define(["./Flotr","./DOM"],e):e(Flotr,Flotr.DOM)}(function(e,t){"use strict";e.addPlugin("labels",{callbacks:{"flotr:afterdraw":function(){this.labels.draw()}},draw:function(){function b(t,n,i){var s=i?n.minorTicks:n.ticks,o=n.orientation===1,a=n.n===1,c,p,d,g;c={color:n.options.color||v.grid.color,angle:e.toRad(n.options.labelsAngle),textBaseline:"middle"};for(h=0;h<s.length&&(i?n.options.showMinorLabels:n.options.showLabels);++h){r=s[h],r.label+="";if(!r.label||!r.label.length)continue;d=Math.cos(h*f+l)*u,g=Math.sin(h*f+l)*u,c.textAlign=o?Math.abs(d)<.1?"center":d<0?"right":"left":"left",e.drawText(m,r.label,o?d:3,o?g:-(n.ticks[h].v/n.max)*(u-v.fontSize),c)}}function w(t,n,i,s){function l(e){return e.options.showLabels&&e.used}function c(e,t,n,r){return e.plotOffset.left+(t?r:n?-v.grid.labelMargin:v.grid.labelMargin+e.plotWidth)}function p(e,t,n,r){return e.plotOffset.top+(t?v.grid.labelMargin:r)+(t&&n?e.plotHeight:0)}var o=n.orientation===1,u=n.n===1,a,f;a={color:n.options.color||v.grid.color,textAlign:i,textBaseline:s,angle:e.toRad(n.options.labelsAngle)},a=e.getBestTextAlign(a.angle,a);for(h=0;h<n.ticks.length&&l(n);++h){r=n.ticks[h];if(!r.label||!r.label.length)continue;f=n.d2p(r.v);if(f<0||f>(o?t.plotWidth:t.plotHeight))continue;e.drawText(m,r.label,c(t,o,u,f),p(t,o,u,f),a),!o&&!u&&(m.save(),m.strokeStyle=a.color,m.beginPath(),m.moveTo(t.plotOffset.left+t.plotWidth-8,t.plotOffset.top+n.d2p(r.v)),m.lineTo(t.plotOffset.left+t.plotWidth,t.plotOffset.top+n.d2p(r.v)),m.stroke(),m.restore())}}function E(e,t){var n=t.orientation===1,i=t.n===1,s="",u,a,f,l=e.plotOffset;!n&&!i&&(m.save(),m.strokeStyle=t.options.color||v.grid.color,m.beginPath());if(t.options.showLabels&&(i?!0:t.used))for(h=0;h<t.ticks.length;++h){r=t.ticks[h];if(!r.label||!r.label.length||(n?l.left:l.top)+t.d2p(r.v)<0||(n?l.left:l.top)+t.d2p(r.v)>(n?e.canvasWidth:e.canvasHeight))continue;f=l.top+(n?(i?1:-1)*(e.plotHeight+v.grid.labelMargin):t.d2p(r.v)-t.maxLabel.height/2),u=n?l.left+t.d2p(r.v)-o/2:0,s="",h===0?s=" first":h===t.ticks.length-1&&(s=" last"),s+=n?" flotr-grid-label-x":" flotr-grid-label-y",p+=['<div style="position:absolute; text-align:'+(n?"center":"right")+"; ","top:"+f+"px; ",(!n&&!i?"right:":"left:")+u+"px; ","width:"+(n?o:(i?l.left:l.right)-v.grid.labelMargin)+"px; ",t.options.color?"color:"+t.options.color+"; ":" ",'" class="flotr-grid-label'+s+'">'+r.label+"</div>"].join(" "),!n&&!i&&(m.moveTo(l.left+e.plotWidth-8,l.top+t.d2p(r.v)),m.lineTo(l.left+e.plotWidth,l.top+t.d2p(r.v)))}}var n,r,i,s,o,u,a,f,l,c,h,p="",d=0,v=this.options,m=this.ctx,g=this.axes,y={size:v.fontSize};for(h=0;h<g.x.ticks.length;++h)g.x.ticks[h].label&&++d;o=this.plotWidth/d,v.grid.circular&&(m.save(),m.translate(this.plotOffset.left+this.plotWidth/2,this.plotOffset.top+this.plotHeight/2),u=this.plotHeight*v.radar.radiusRatio/2+v.fontSize,a=this.axes.x.ticks.length,f=2*(Math.PI/a),l=-Math.PI/2,b(this,g.x,!1),b(this,g.x,!0),b(this,g.y,!1),b(this,g.y,!0),m.restore()),!v.HtmlText&&this.textEnabled?(w(this,g.x,"center","top"),w(this,g.x2,"center","bottom"),w(this,g.y,"right","middle"),w(this,g.y2,"left","middle")):(g.x.options.showLabels||g.x2.options.showLabels||g.y.options.showLabels||g.y2.options.showLabels)&&!v.grid.circular&&(p="",E(this,g.x),E(this,g.x2),E(this,g.y),E(this,g.y2),m.stroke(),m.restore(),c=t.create("div"),t.setStyles(c,{fontSize:"smaller",color:v.grid.color}),c.className="flotr-labels",t.insert(this.el,c),t.insert(c,p))}})}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("./Flotr"),require("../lib/underscore"),require("./DOM"),require("./EventAdapter")):typeof define=="function"&&define.amd?define(["./Flotr","underscore","./DOM","./EventAdapter"],e):e(Flotr,_,Flotr.DOM,Flotr.EventAdapter)}(function(e,t,n,r){"use strict";e.addPlugin("legend",{options:{show:!0,noColumns:1,labelFormatter:function(e){return e},labelBoxBorderColor:"#CCCCCC",labelBoxWidth:14,labelBoxHeight:10,labelBoxMargin:5,container:null,position:"nw",margin:5,backgroundColor:"#F0F0F0",backgroundOpacity:.85},callbacks:{"flotr:afterinit":function(){this.legend.insertLegend()},"flotr:destroy":function(){var e=this.legend.markup;e&&(this.legend.markup=null,n.remove(e))}},insertLegend:function(){if(!this.options.legend.show)return;var r=this.series,i=this.plotOffset,s=this.options,o=s.legend,u=[],a=!1,f=this.ctx,l=t.filter(r,function(e){return e.label&&!e.hide}).length,c=o.position,h=o.margin,p=o.backgroundOpacity,d,v,m;if(l){var g=o.labelBoxWidth,y=o.labelBoxHeight,b=o.labelBoxMargin,w=i.left+h,E=i.top+h,S=0,x={size:s.fontSize*1.1,color:s.grid.color};for(d=r.length-1;d>-1;--d){if(!r[d].label||r[d].hide)continue;v=o.labelFormatter(r[d].label),S=Math.max(S,this._text.measureText(v,x).width)}var T=Math.round(g+b*3+S),N=Math.round(l*(b+y)+b);!p&&p!==0&&(p=.1);if(!s.HtmlText&&this.textEnabled&&!o.container){c.charAt(0)=="s"&&(E=i.top+this.plotHeight-(h+N)),c.charAt(0)=="c"&&(E=i.top+this.plotHeight/2-(h+N/2)),c.charAt(1)=="e"&&(w=i.left+this.plotWidth-(h+T)),m=this.processColor(o.backgroundColor,{opacity:p}),f.fillStyle=m,f.fillRect(w,E,T,N),f.strokeStyle=o.labelBoxBorderColor,f.strokeRect(e.toPixel(w),e.toPixel(E),T,N);var C=w+b,k=E+b;for(d=0;d<r.length;d++){if(!r[d].label||r[d].hide)continue;v=o.labelFormatter(r[d].label),f.fillStyle=r[d].color,f.fillRect(C,k,g-1,y-1),f.strokeStyle=o.labelBoxBorderColor,f.lineWidth=1,f.strokeRect(Math.ceil(C)-1.5,Math.ceil(k)-1.5,g+2,y+2),e.drawText(f,v,C+g+b,k+y,x),k+=y+b}}else{for(d=0;d<r.length;++d){if(!r[d].label||r[d].hide)continue;d%o.noColumns===0&&(u.push(a?"</tr><tr>":"<tr>"),a=!0);var L=r[d],A=o.labelBoxWidth,O=o.labelBoxHeight;v=o.labelFormatter(L.label),m="background-color:"+(L.bars&&L.bars.show&&L.bars.fillColor&&L.bars.fill?L.bars.fillColor:L.color)+";",u.push('<td class="flotr-legend-color-box">','<div style="border:1px solid ',o.labelBoxBorderColor,';padding:1px">','<div style="width:',A-1,"px;height:",O-1,"px;border:1px solid ",r[d].color,'">','<div style="width:',A,"px;height:",O,"px;",m,'"></div>',"</div>","</div>","</td>",'<td class="flotr-legend-label">',v,"</td>")}a&&u.push("</tr>");if(u.length>0){var M='<table style="font-size:smaller;color:'+s.grid.color+'">'+u.join("")+"</table>";if(o.container)M=n.node(M),this.legend.markup=M,n.insert(o.container,M);else{var P={position:"absolute",zIndex:"2",border:"1px solid "+o.labelBoxBorderColor};c.charAt(0)=="n"?(P.top=h+i.top+"px",P.bottom="auto"):c.charAt(0)=="c"?(P.top=h+(this.plotHeight-N)/2+"px",P.bottom="auto"):c.charAt(0)=="s"&&(P.bottom=h+i.bottom+"px",P.top="auto"),c.charAt(1)=="e"?(P.right=h+i.right+"px",P.left="auto"):c.charAt(1)=="w"&&(P.left=h+i.left+"px",P.right="auto");var H=n.create("div"),B;H.className="flotr-legend",n.setStyles(H,P),n.insert(H,M),n.insert(this.el,H);if(!p)return;var j=o.backgroundColor||s.grid.backgroundColor||"#ffffff";t.extend(P,n.size(H),{backgroundColor:j,zIndex:"",border:""}),P.width+="px",P.height+="px",H=n.create("div"),H.className="flotr-legend-bg",n.setStyles(H,P),n.opacity(H,p),n.insert(H," "),n.insert(this.el,H)}}}}}})}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("./Flotr"),require("./DOM")):typeof define=="function"&&define.amd?define(["./Flotr","./DOM"],e):e(Flotr,Flotr.DOM)}(function(e,t){"use strict";e.addPlugin("titles",{callbacks:{"flotr:afterdraw":function(){this.titles.drawTitles()}},drawTitles:function(){var n,r=this.options,i=r.grid.labelMargin,s=this.ctx,o=this.axes;if(!r.HtmlText&&this.textEnabled){var u={size:r.fontSize,color:r.grid.color,textAlign:"center"};r.subtitle&&e.drawText(s,r.subtitle,this.plotOffset.left+this.plotWidth/2,this.titleHeight+this.subtitleHeight-2,u),u.weight=1.5,u.size*=1.5,r.title&&e.drawText(s,r.title,this.plotOffset.left+this.plotWidth/2,this.titleHeight-2,u),u.weight=1.8,u.size*=.8,o.x.options.title&&o.x.used&&(u.textAlign=o.x.options.titleAlign||"center",u.textBaseline="top",u.angle=e.toRad(o.x.options.titleAngle),u=e.getBestTextAlign(u.angle,u),e.drawText(s,o.x.options.title,this.plotOffset.left+this.plotWidth/2,this.plotOffset.top+o.x.maxLabel.height+this.plotHeight+2*i,u)),o.x2.options.title&&o.x2.used&&(u.textAlign=o.x2.options.titleAlign||"center",u.textBaseline="bottom",u.angle=e.toRad(o.x2.options.titleAngle),u=e.getBestTextAlign(u.angle,u),e.drawText(s,o.x2.options.title,this.plotOffset.left+this.plotWidth/2,this.plotOffset.top-o.x2.maxLabel.height-2*i,u)),o.y.options.title&&o.y.used&&(u.textAlign=o.y.options.titleAlign||"right",u.textBaseline="middle",u.angle=e.toRad(o.y.options.titleAngle),u=e.getBestTextAlign(u.angle,u),e.drawText(s,o.y.options.title,this.plotOffset.left-o.y.maxLabel.width-2*i,this.plotOffset.top+this.plotHeight/2,u)),o.y2.options.title&&o.y2.used&&(u.textAlign=o.y2.options.titleAlign||"left",u.textBaseline="middle",u.angle=e.toRad(o.y2.options.titleAngle),u=e.getBestTextAlign(u.angle,u),e.drawText(s,o.y2.options.title,this.plotOffset.left+this.plotWidth+o.y2.maxLabel.width+2*i,this.plotOffset.top+this.plotHeight/2,u))}else{n=[],r.title&&n.push('<div style="position:absolute;top:0;left:',this.plotOffset.left,"px;font-size:1em;font-weight:bold;text-align:center;width:",this.plotWidth,'px;" class="flotr-title">',r.title,"</div>"),r.subtitle&&n.push('<div style="position:absolute;top:',this.titleHeight,"px;left:",this.plotOffset.left,"px;font-size:smaller;text-align:center;width:",this.plotWidth,'px;" class="flotr-subtitle">',r.subtitle,"</div>"),n.push("</div>"),n.push('<div class="flotr-axis-title" style="font-weight:bold;">'),o.x.options.title&&o.x.used&&n.push('<div style="position:absolute;top:',this.plotOffset.top+this.plotHeight+r.grid.labelMargin+o.x.titleSize.height,"px;left:",this.plotOffset.left,"px;width:",this.plotWidth,"px;text-align:",o.x.options.titleAlign,';" class="flotr-axis-title flotr-axis-title-x1">',o.x.options.title,"</div>"),o.x2.options.title&&o.x2.used&&n.push('<div style="position:absolute;top:0;left:',this.plotOffset.left,"px;width:",this.plotWidth,"px;text-align:",o.x2.options.titleAlign,';" class="flotr-axis-title flotr-axis-title-x2">',o.x2.options.title,"</div>"),o.y.options.title&&o.y.used&&n.push('<div style="position:absolute;top:',this.plotOffset.top+this.plotHeight/2-o.y.titleSize.height/2,"px;left:0;text-align:",o.y.options.titleAlign,';" class="flotr-axis-title flotr-axis-title-y1">',o.y.options.title,"</div>"),o.y2.options.title&&o.y2.used&&n.push('<div style="position:absolute;top:',this.plotOffset.top+this.plotHeight/2-o.y.titleSize.height/2,"px;right:0;text-align:",o.y2.options.titleAlign,';" class="flotr-axis-title flotr-axis-title-y2">',o.y2.options.title,"</div>"),n=n.join("");var a=t.create("div");t.setStyles({color:r.grid.color}),a.className="flotr-titles",t.insert(this.el,a),t.insert(a,n)}}})})